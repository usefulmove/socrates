% enso pandoc LaTeX template
% engine: xelatex
% 
% designed for use with Pandoc and the xelatex engine

% --- Document Class ---
% Sets the base font size and paper size. Pandoc can override this with the
% 'fontsize' and 'papersize' variables.
\documentclass[$if(fontsize)$$fontsize$$else$12pt$endif$]{article}

% --- Font & Unicode Setup (fontspec) ---
% fontspec is the modern package for loading system fonts with XeLaTeX and LuaLaTeX.
\usepackage{fontspec}

% Set the main body font. Pandoc's 'mainfont' variable can override this.
% Ensure these fonts are installed on your system or replace them with available ones.
% You can also uncomment 'Path = /usr/share/fonts/TTF/' if your fonts are there.
$if(mainfont)$
  \setmainfont{$mainfont$}
$else$
  \setmainfont{DejaVu Sans}
$endif$

% Set the sans-serif font, used for headings. Pandoc's 'sansfont' can override.
% Ensure these fonts are installed on your system or replace them with available ones.
$if(sansfont)$
  \setsansfont{$sansfont$}[ 
    BoldFont = * Bold
  ]
$else$
  \setsansfont{DejaVu Sans}[ 
    BoldFont = * Bold
  ]
$endif$

% Set the monospace font, used for code. Pandoc's 'monofont' can override.
% 'Scale=MatchLowercase' adjusts the font size to align with the main font.
% Ensure these fonts are installed on your system or replace them with available ones.
$if(monofont)$
  \setmonofont{$monofont$}[ 
    Scale=MatchLowercase
  ]
$else$
  \setmonofont{Space Mono}[ 
    Scale=MatchLowercase
  ]
$endif$

% --- Layout & Geometry ---
% 'geometry' is used to set margins. The 'geometry' variable can override this.
% Example in YAML: geometry: "margin=2in"
\usepackage[$if(geometry)$$geometry$$else$margin=1in$endif$]{geometry}
\usepackage{longtable} % Required for tables that span multiple pages
\usepackage{booktabs} % For professional looking tables (\toprule, \midrule, \bottomrule)

% 'parskip' package creates space between paragraphs instead of indenting the first line.
\usepackage{parskip}

% 'leading' package provides easy control over line spacing (leading).
\usepackage{setspace}
\setstretch{1.2} % Set line spacing to 120% of the font size

\usepackage{xcolor} % For defining custom colors
\definecolor{codebackground}{RGB}{248,248,248} % Light gray background
\definecolor{codeborder}{RGB}{220,220,220} % Subtle border color

% Fix for \passthrough command generated by some Pandoc versions with --listings
\newcommand{\passthrough}[1]{#1}

% 'listings' package for code blocks
\usepackage{listings}

% Pandoc inserts \tightlist for compact lists when converting Markdown.
% Define it to avoid compilation errors on list-heavy documents.
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}%
  \setlength{\parskip}{0pt}%
}

% Style for code blocks
\lstdefinestyle{enso}{
  backgroundcolor=\color{codebackground},
  frame=single,
  rulecolor=\color{codeborder},
  numbers=left,
  numberstyle=\tiny\color{gray},
  numbersep=5pt,
  basicstyle=\fontsize{10}{12}\selectfont\ttfamily,
  breakatwhitespace=false,
  breaklines=true,
  captionpos=b,
  keepspaces=true,
  showspaces=false,
  showstringspaces=false,
  showtabs=false,
  tabsize=2
}
\lstset{style=enso}

% --- Typography for Headings (titlesec) ---
% 'titlesec' allows customization of section, subsection, etc. headings.
% Here, we set all headings to use the main document font (non-bold).
\usepackage{titlesec}
\titleformat{\section}{\normalfont\rmfamily\Large}{\thesection}{1em}{}
\titleformat{\subsection}{\normalfont\rmfamily\large}{\thesubsection}{1em}{}
\titleformat{\subsubsection}{\normalfont\rmfamily\normalsize}{\thesubsubsection}{1em}{}


% --- Code Block Styling (listings) ---
% To use this styling, you MUST use the '--listings' flag with Pandoc.
% For example: pandoc your_file.md -o output.pdf --listings
% Pandoc will then generate \begin{lstlisting} environments for code blocks,
% and the style defined above will be applied automatically.


% --- Hyperlinks (hyperref) ---
% 'hyperref' adds clickable links for URLs, references, and the TOC.
\usepackage{hyperref}
\hypersetup{
    colorlinks=true,       % false: boxed links; true: colored links
    linkcolor=blue!50!black,  % color of internal links (e.g., sections)
    citecolor=green!50!black, % color of links to bibliography
    filecolor=magenta!50!black,% color of file links
    urlcolor=blue!80!black,    % color of external links
    breaklinks=true,         % Allow links to break across lines
    pdfborder={0 0 0},       % Remove the box around links
}
$if(url)$
\url{$url$}
$endif$

% --- Title Block ---
% Standard Pandoc variables for title, author, and date.
$if(title)$
\title{$title$}
$endif$
$if(author)$
\author{$for(author)$$author$$sep$ \and $endfor$}
$endif$
$if(date)$
\date{$date$}
$endif$

% --- Document Body ---
\begin{document}

% Render the title block if a title is set
$if(title)$
\maketitle
$endif$

% Render the Table of Contents if 'toc' is true
$if(toc)$
{ 
  \hypersetup{linkcolor=black} % Use black links for the TOC
  \tableofcontents
}
$endif$

% The main document content generated by Pandoc
$body$

\end{document}
